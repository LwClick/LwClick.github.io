<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Tomcat⼀个运⾏JAVA的⽹络服务器，底层是Socket的⼀个程序，它也是JSP和Serlvet的⼀个容器。     URL和URI     Tomcat目录结构     虚拟目录  在其他盘符下创建⼀个web站点⽬录，并创建WEB-INF⽬录和⼀个html⽂件。  找到Tomcat⽬录下&#x2F;conf&#x2F;server.xml⽂件  在server.xml中的 节点下添加如下代码。 path表示的是">
<meta property="og:type" content="article">
<meta property="og:title" content="servlet">
<meta property="og:url" content="http://yoursite.com/2020/05/15/servlet/index.html">
<meta property="og:site_name" content="绝对领域">
<meta property="og:description" content="Tomcat⼀个运⾏JAVA的⽹络服务器，底层是Socket的⼀个程序，它也是JSP和Serlvet的⼀个容器。     URL和URI     Tomcat目录结构     虚拟目录  在其他盘符下创建⼀个web站点⽬录，并创建WEB-INF⽬录和⼀个html⽂件。  找到Tomcat⽬录下&#x2F;conf&#x2F;server.xml⽂件  在server.xml中的 节点下添加如下代码。 path表示的是">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430131308.png">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430131446.png">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430131507.png">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430175929.png">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430182222.png">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430183607.png">
<meta property="og:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430203421.png">
<meta property="article:published_time" content="2020-05-15T12:58:44.000Z">
<meta property="article:modified_time" content="2020-05-15T12:58:44.874Z">
<meta property="article:author" content="xCoding">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430131308.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/05/15/servlet/"/>





  <title>servlet | 绝对领域</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">绝对领域</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">lwclick</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/15/servlet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xCoding">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://gitee.com/lwclick/blogImg/raw/master/img/959e5d02246fb23f5d5f613f7767eeac.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="绝对领域">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">servlet</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-15T20:58:44+08:00">
                2020-05-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/fighting/" itemprop="url" rel="index">
                    <span itemprop="name">fighting</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2020/05/15/servlet/" class="leancloud_visitors" data-flag-title="servlet">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  31
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h2><p>⼀个运⾏JAVA的⽹络服务器，底层是Socket的⼀个程序，它也是JSP和Serlvet的⼀个容器。</p>
<img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM截图20200430131308.png" alt="TIM截图20200430131308" style="zoom:80%;" />



<p><strong>URL和URI</strong></p>
<img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM截图20200430131446.png" alt="TIM截图20200430131446" style="zoom:50%;" />



<p><strong>Tomcat目录结构</strong></p>
<img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM截图20200430131507.png" alt="TIM截图20200430131507" style="zoom:80%;" />



<p><strong>虚拟目录</strong></p>
<ol>
<li><p>在其他盘符下创建⼀个web站点⽬录，并创建WEB-INF⽬录和⼀个html⽂件。</p>
</li>
<li><p>找到Tomcat⽬录下/conf/server.xml⽂件</p>
</li>
<li><p>在server.xml中的<Host> 节点下添加如下代码。</p>
<p><strong>path</strong>表示的是访问时输⼊的<strong>web项⽬名</strong>，<strong>docBase</strong>表示的是<strong>站点⽬录的绝对路径</strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Context path=<span class="string">"/web1"</span> docBase=<span class="string">"D:\web1"</span>/&gt;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<p><strong>虚拟主机</strong></p>
<ol>
<li><p>在tomcat的server.xml⽂件中添加主机名</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name=<span class="string">"lwclick"</span> appBase=<span class="string">"D:\web1"</span>&gt;</span><br><span class="line">	&lt;Context path=<span class="string">"/web1"</span> docBase=<span class="string">"D:\web1"</span>/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问：<code>lwclick：8080/web1/test.html</code></p>
</li>
</ol>
<p><strong>浏览器访问WEB资源的流程图</strong></p>
<img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM截图20200430175929.png" alt="TIM截图20200430175929" style="zoom:90%;" />

<hr>
<h2 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h2><h3 id="1-什么是Servlet？"><a href="#1-什么是Servlet？" class="headerlink" title="1. 什么是Servlet？"></a>1. 什么是Servlet？</h3><p>是⼀个遵循Servlet开发的java类。Servlet是<strong>由服务器调⽤的</strong>，运⾏在服务器端。</p>
<h3 id="2-HTTP协议"><a href="#2-HTTP协议" class="headerlink" title="2. HTTP协议"></a>2. HTTP协议</h3><h4 id="2-1-什么是HTPP协议"><a href="#2-1-什么是HTPP协议" class="headerlink" title="2.1 什么是HTPP协议"></a>2.1 什么是HTPP协议</h4><p>超⽂本传输协议（HTTP，HyperText Transfer Protocol)是互联⽹上应⽤最为⼴泛的⼀种⽹络协议。所有的WWW⽂件都必须遵守这个标准。它是<strong>TCP/IP协议</strong>的⼀个<strong>应⽤层协议</strong></p>
<p>HTTP协议就是客户端和服务器交互的⼀种通迅的格式。</p>
<h4 id="2-2-HTTP1-0和HTTP1-1的区别"><a href="#2-2-HTTP1-0和HTTP1-1的区别" class="headerlink" title="2.2 HTTP1.0和HTTP1.1的区别"></a>2.2 HTTP1.0和HTTP1.1的区别</h4><ul>
<li>HTTP1.0协议，客户端与web服务器建⽴连接后，只能获得⼀个web资源【短连接，获取资源后就断开】</li>
<li>HTTP1.1协议，允许客户端与web服务器建⽴连接后，在⼀个连接上获取多个web资源【保持连接】</li>
</ul>
<h4 id="2-3-HTTP请求"><a href="#2-3-HTTP请求" class="headerlink" title="2.3 HTTP请求"></a>2.3 HTTP请求</h4><p>浏览器向服务器请求某个web资源时，称之为<strong>浏览器</strong>向<strong>服务器</strong>发送了⼀个http请求。</p>
<p>http请求应该包含三个部分：</p>
<ol>
<li>请求⾏【描述客户端的请求⽅式、请求的资源名称，以及使⽤的HTTP协议版本号】</li>
<li>多个消息头【描述客户端请求哪台主机，以及客户端的⼀些环境信息等】</li>
<li>⼀个空⾏</li>
</ol>
<h5 id="2-3-1-请求行"><a href="#2-3-1-请求行" class="headerlink" title="2.3.1 请求行"></a>2.3.1 请求行</h5><ul>
<li><p><strong>GET</strong>：⽤来查询数据，提交速度快，在URL地址后附带的参数是有限制的，其数据容量通常不能超过1K。</p>
</li>
<li><p><strong>POST</strong>：⽤来提交数据，可以在请求的实体内容中向服务器发送数据，传送的数据量⽆限制。</p>
</li>
</ul>
<h5 id="2-3-2-请求头"><a href="#2-3-2-请求头" class="headerlink" title="2.3.2 请求头"></a>2.3.2 请求头</h5><p>Accept: text/html,image/*           Accept-Encoding: gzip,compress            Accept-Charset: ISO-8859-1</p>
<h4 id="2-4-HTTP响应"><a href="#2-4-HTTP响应" class="headerlink" title="2.4 HTTP响应"></a>2.4 HTTP响应</h4><p>⼀个HTTP响应代表着<strong>服务器</strong>向<strong>浏览器</strong>回送数据</p>
<p>HTTP响应应该包含四个部分:</p>
<ol>
<li>⼀个状态⾏【描述服务器对请求的处理结果。】</li>
<li>多个消息头【描述服务器的基本信息以及数据，通过描述信息，可以通知客户端如何处理服务器回送的数据】</li>
<li>⼀个空⾏</li>
<li>实体内容【服务器向客户端回送的数据】</li>
</ol>
<h5 id="2-4-1-状态⾏"><a href="#2-4-1-状态⾏" class="headerlink" title="2.4.1 状态⾏"></a>2.4.1 状态⾏</h5><p>格式： HTTP版本号　  状态码　原因叙述<br>状态⾏：HTTP/1.1          200           OK</p>
<p>​                                          404           客户端的请求有错误</p>
<p>​                                          500           服务器有错误 </p>
<h5 id="2-4-2-响应头"><a href="#2-4-2-响应头" class="headerlink" title="2.4.2 响应头"></a>2.4.2 响应头</h5><p>Server:apache tomcat       Content-Encoding: gzip       Content-Type: text/html; charset=GB2312</p>
<h3 id="3-servlet生命周期（面试题）"><a href="#3-servlet生命周期（面试题）" class="headerlink" title="3. servlet生命周期（面试题）"></a>3. servlet生命周期（面试题）</h3><ol>
<li><strong>加载Servlet</strong>。当Tomcat<strong>第⼀次访问Servlet</strong>的时候，Tomcat会负责<strong>创建Servlet的实例</strong></li>
<li><strong>初始化</strong>。当<strong>Servlet被实例化后</strong>，Tomcat会调⽤<strong>init()</strong>⽅法<strong>初始化这个对象</strong></li>
<li><strong>处理服务</strong>。当<strong>浏览器访问Servlet</strong>的时候，Servlet 会调⽤<strong>service()⽅法</strong>处理请求</li>
<li><strong>销毁</strong>。当<strong>Tomcat关闭时</strong>或者检测到<strong>Servlet要从Tomcat删除的时候</strong>会⾃动调⽤<strong>destroy()</strong>⽅法，让该<br>实例释放掉所占的资源。⼀个Servlet如果⻓时间不被使⽤的话，也会被Tomcat⾃动销毁</li>
<li><strong>卸载</strong>。当Servlet调⽤完<strong>destroy()⽅法后</strong>，等待<strong>垃圾回收</strong>。如果有需要再次使⽤这个Servlet，会重<br>新调⽤init()⽅法进⾏初始化操作。</li>
</ol>
<ul>
<li><p>只要访问Servlet，service()就会被调⽤。</p>
</li>
<li><p>init()只有第⼀次访问Servlet的时候才会被调⽤。</p>
</li>
<li><p>destroy()只有在Tomcat关闭的时候才会被调⽤。</p>
</li>
</ul>
<h3 id="4-servlet编写"><a href="#4-servlet编写" class="headerlink" title="4. servlet编写"></a>4. servlet编写</h3><ul>
<li><p>继承HttpServlet，重写service方法</p>
</li>
<li><p>配置web.xml文件</p>
</li>
</ul>
<p><img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430182222.png" alt="TIM截图20200430182222"></p>
<hr>
<h2 id="细节问题"><a href="#细节问题" class="headerlink" title="细节问题"></a>细节问题</h2><h3 id="1-servlet细节"><a href="#1-servlet细节" class="headerlink" title="1. servlet细节"></a>1. servlet细节</h3><h4 id="1-1-⼀个已经注册的Servlet可以被多次映射"><a href="#1-1-⼀个已经注册的Servlet可以被多次映射" class="headerlink" title="1.1 ⼀个已经注册的Servlet可以被多次映射"></a>1.1 ⼀个已经注册的Servlet可以被多次映射</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>lwclick.web.Demo1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Demo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="1-2-Servlet映射的URL可以使⽤通配符"><a href="#1-2-Servlet映射的URL可以使⽤通配符" class="headerlink" title="1.2 Servlet映射的URL可以使⽤通配符"></a>1.2 Servlet映射的URL可以使⽤通配符</h4><p>通配符有两种格式：</p>
<ol>
<li>*. 扩展名</li>
<li>正斜杠（/）开头并以“/*”结尾。</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;Demo1&lt;/servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;<span class="comment">/*&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">&lt;/servlet-mapping&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="1-3-Servlet是单例的（面试题）"><a href="#1-3-Servlet是单例的（面试题）" class="headerlink" title="1.3 Servlet是单例的（面试题）"></a>1.3 Servlet是单例的（面试题）</h4><ul>
<li><p>Servlet对象⼀旦创建了，就会驻留在内存中，为后续的请求做服务，直到服务器关闭。</p>
</li>
<li><p>每次访问请求，都创建新的请求对象(HttpServletRequest)和响应对象(HttpServletResponse)</p>
</li>
<li><p>多个⽤户访问Servlet的时候，服务器会为每个⽤户创建⼀个线程。当多个⽤户<strong>并发访问Servlet共享资源</strong>的时候就会出现线程安全问题。</p>
<ul>
<li>如果<strong>⼀个变量需要多个用户共享</strong>，则应当在访问该变量的时候，加同步机制<strong>synchronized (对象){}</strong></li>
<li>如果⼀个变量<strong>不需要共享</strong>，则直接在service()中定义.这样不会存在线程安全问题</li>
</ul>
</li>
</ul>
<h4 id="1-4-load-on-startup"><a href="#1-4-load-on-startup" class="headerlink" title="1.4 load-on-startup"></a>1.4 load-on-startup</h4><p>如果在<code>&lt;servlet&gt;</code>元素中配置了⼀个<code>&lt;load-on-startup&gt;</code> 元素，那么WEB应⽤程序在启动时，就会装载并创建Servlet的实例对象、以及调⽤Servlet实例对象的init()⽅法。</p>
<img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM截图20200430183607.png" alt="TIM截图20200430183607" style="zoom:80%;" />

<p><strong>作用：</strong></p>
<ol>
<li>为web应⽤写⼀个InitServlet，这个servlet配置为启动时装载，<strong>为整个web应⽤创建必要的数据库表和数据</strong></li>
<li>完成⼀些定时的任务【定时写⽇志，定时备份数据】</li>
</ol>
<h4 id="1-5-在web访问任何资源都是在访问servlet"><a href="#1-5-在web访问任何资源都是在访问servlet" class="headerlink" title="1.5 在web访问任何资源都是在访问servlet"></a>1.5 在web访问任何资源都是在访问servlet</h4><p>⽆论在web中访问什么资源【包括JSP】，都是在访问Servlet。</p>
<p>没有⼿⼯配置缺省Servlet的时候，你访问静态图⽚，静态⽹⻚，缺省Servlet会在你web站点中寻找该图⽚或⽹⻚，如果有就返回给浏览器，没有就报404错误</p>
<h3 id="2-ServletConfig对象"><a href="#2-ServletConfig对象" class="headerlink" title="2. ServletConfig对象"></a>2. ServletConfig对象</h3><h4 id="2-1-ServletConfig对象有什么⽤？"><a href="#2-1-ServletConfig对象有什么⽤？" class="headerlink" title="2.1 ServletConfig对象有什么⽤？"></a>2.1 ServletConfig对象有什么⽤？</h4><p>通过此对象可以读取web.xml中配置的初始化参数。能够让程序更加灵活【更换需求，更改配置⽂件web.xml即可，程序代码不⽤改】</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;Demo1&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-<span class="class"><span class="keyword">class</span>&gt;<span class="title">zhongfucheng</span>.<span class="title">web</span>.<span class="title">Demo1</span>&lt;/<span class="title">servlet</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">    </span></span><br><span class="line"><span class="class">    &lt;<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">param</span>-<span class="title">name</span>&gt;<span class="title">name</span>&lt;/<span class="title">param</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">param</span>-<span class="title">value</span>&gt;<span class="title">zhongfucheng</span>&lt;/<span class="title">param</span>-<span class="title">value</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">servlet</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;<span class="title">servlet</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">servlet</span>-<span class="title">name</span>&gt;<span class="title">Demo1</span>&lt;/<span class="title">servlet</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">url</span>-<span class="title">pattern</span>&gt;/<span class="title">Demo1</span>&lt;/<span class="title">url</span>-<span class="title">pattern</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">servlet</span>-<span class="title">mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/lwclick/blogImg/raw/master/img/TIM%E6%88%AA%E5%9B%BE20200430203421.png" alt="TIM截图20200430203421"></p>
<h3 id="3-ServletContext对象"><a href="#3-ServletContext对象" class="headerlink" title="3. ServletContext对象"></a>3. ServletContext对象</h3><h4 id="3-1-什么是ServletContext对象？"><a href="#3-1-什么是ServletContext对象？" class="headerlink" title="3.1 什么是ServletContext对象？"></a>3.1 什么是ServletContext对象？</h4><p>当Tomcat启动的时候，就会创建⼀个ServletContext对象。它代表着<strong>当前web站点</strong></p>
<h4 id="3-2-ServletContext有什么⽤？"><a href="#3-2-ServletContext有什么⽤？" class="headerlink" title="3.2 ServletContext有什么⽤？"></a>3.2 ServletContext有什么⽤？</h4><ol>
<li>ServletContext既然代表着当前web站点，那么所有Servlet都共享着⼀个ServletContext对象，所以Servlet之间<strong>可以通过ServletContext实现通讯</strong>。</li>
<li><strong>ServletConfig</strong>获取的是配置的是<strong>单个Servlet的参数信息</strong>，<strong>ServletContext</strong>可以获取的是配置<strong>整个web站点的参数信息</strong></li>
<li>利⽤ServletContext<strong>读取web站点的资源⽂件</strong></li>
<li>实现Servlet的转发【不常用】</li>
</ol>
<h4 id="3-3-Servlet之间实现通讯"><a href="#3-3-Servlet之间实现通讯" class="headerlink" title="3.3 Servlet之间实现通讯"></a>3.3 Servlet之间实现通讯</h4><p>ServletContext对象可以被称之为<strong>域对象</strong>，可以简单理解成⼀个容器【类似于Map集合】</p>
<p><strong>通过serAttribute实现通讯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到ServletContext对象</span></span><br><span class="line">ServletContext servletContext = <span class="keyword">this</span>.getServletContext();</span><br><span class="line"></span><br><span class="line">String value = <span class="string">"lwclick"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MyName作为关键字，value作为值存进 域对象【类型于Map集合】</span></span><br><span class="line">servletContext.setAttribute(<span class="string">"MyName"</span>, value);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取ServletContext对象</span></span><br><span class="line">ServletContext servletContext = <span class="keyword">this</span>.getServletContext();</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过关键字获取存储在域对象的值</span></span><br><span class="line">String value = (String) servletContext.getAttribute(<span class="string">"MyName"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(value);</span><br></pre></td></tr></table></figure>



<h4 id="3-4-获取web站点配置的信息"><a href="#3-4-获取web站点配置的信息" class="headerlink" title="3.4 获取web站点配置的信息"></a>3.4 获取web站点配置的信息</h4><ul>
<li>web.xml⽂件⽀持对整个站点进⾏配置参数信息【所有Servlet都可以取到该参数信息】</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>lwclick<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到ServletContext对象</span></span><br><span class="line">ServletContext servletContext = <span class="keyword">this</span>.getServletContext();</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过名称获取值</span></span><br><span class="line">String value = servletContext.getInitParameter(<span class="string">"name"</span>);</span><br><span class="line">System.out.println(value);</span><br></pre></td></tr></table></figure>



<h4 id="3-5-读取资源文件"><a href="#3-5-读取资源文件" class="headerlink" title="3.5 读取资源文件"></a>3.5 读取资源文件</h4><p>⽂件放在web⽬录下，直接通过⽂件名称就能获取（web –&gt; WEB-INF –&gt; 资源文件）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到ServletContext对象</span></span><br><span class="line">ServletContext servletContext = <span class="keyword">this</span>.getServletContext();</span><br><span class="line"></span><br><span class="line"><span class="comment">//调⽤ServletContext⽅法获取到读取⽂件的流</span></span><br><span class="line">InputStream inputStream = servletContext.getResourceAsStream(<span class="string">"2.png"</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Response对象"><a href="#Response对象" class="headerlink" title="Response对象"></a>Response对象</h2><h3 id="1-response、request对象"><a href="#1-response、request对象" class="headerlink" title="1. response、request对象"></a>1. response、request对象</h3><ul>
<li><p>Tomcat收到客户端的http请求，针对每⼀次请求，分别创建⼀个<strong>代表请求的request对象</strong>和<strong>代表响应的response对象</strong></p>
</li>
<li><p><strong>获取浏览器提交过来的数据，找request对象</strong></p>
</li>
<li><p><strong>向浏览器输出数据，找response对象</strong></p>
</li>
</ul>
<p>HttpServletResponse对象封装了http响应的信息。</p>
<h3 id="2-HttpServletResponse的应⽤"><a href="#2-HttpServletResponse的应⽤" class="headerlink" title="2. HttpServletResponse的应⽤"></a>2. HttpServletResponse的应⽤</h3><h4 id="2-1-调⽤getOutputStream-⽅法向浏览器输出数据"><a href="#2-1-调⽤getOutputStream-⽅法向浏览器输出数据" class="headerlink" title="2.1 调⽤getOutputStream()⽅法向浏览器输出数据"></a>2.1 调⽤getOutputStream()⽅法向浏览器输出数据</h4><p>二进制数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">"Content-Type"</span>, <span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">response.getOutputStream().write(<span class="string">"你好呀我是中国"</span>.getBytes(<span class="string">"UTF-8"</span>));</span><br></pre></td></tr></table></figure>



<h4 id="2-2-调⽤getWriter-⽅法向浏览器输出数据"><a href="#2-2-调⽤getWriter-⽅法向浏览器输出数据" class="headerlink" title="2.2 调⽤getWriter()⽅法向浏览器输出数据"></a>2.2 调⽤getWriter()⽅法向浏览器输出数据</h4><p>字符数据，不能输出⼆进制数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取到printWriter对象</span></span><br><span class="line">PrintWriter printWriter = response.getWriter();</span><br><span class="line">printWriter.write(<span class="string">"看完博客点赞！"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="2-3-实现⽂件下载"><a href="#2-3-实现⽂件下载" class="headerlink" title="2.3 实现⽂件下载"></a>2.3 实现⽂件下载</h4><p>在web站点下有⼀个图⽚等文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到资源的路径</span></span><br><span class="line">String path = <span class="keyword">this</span>.getServletContext().getRealPath(<span class="string">"/download/1.png"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取资源</span></span><br><span class="line">FileInputStream fis = <span class="keyword">new</span> FileInputStream(path);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取到⽂件名,路径在电脑上保存是\\形式的。</span></span><br><span class="line">String fileName = path.substring(path.lastIndexOf(<span class="string">"\\"</span>) + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置消息头，告诉浏览器，我要下载1.png这个图⽚</span></span><br><span class="line">response.setHeader(<span class="string">"Content-Disposition"</span>, <span class="string">"attachment; filename="</span>+URLEncoder.encode(fileName, <span class="string">"UTF-8"</span>)););</span><br><span class="line"></span><br><span class="line"><span class="comment">//把读取到的资源写给浏览器</span></span><br><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">ServletOutputStream sos = response.getOutputStream();</span><br><span class="line"><span class="keyword">while</span> ((len = fis.read(bytes)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">	sos.write(bytes, <span class="number">0</span>, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭资源</span></span><br><span class="line">servletOutputStream.close();</span><br><span class="line">fileInputStream.close();</span><br></pre></td></tr></table></figure>



<h4 id="2-4-实现自动刷新"><a href="#2-4-实现自动刷新" class="headerlink" title="2.4 实现自动刷新"></a>2.4 实现自动刷新</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">response.getWriter().write(<span class="string">"3秒后跳转⻚⾯....."</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//三秒后跳转到index.jsp⻚⾯去，web应⽤的映射路径我设置成/，url没有写上应⽤名</span></span><br><span class="line">response.setHeader(<span class="string">"Refresh"</span>, <span class="string">"3;url='/index.jsp'"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="2-5-设置缓存"><a href="#2-5-设置缓存" class="headerlink" title="2.5 设置缓存"></a>2.5 设置缓存</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">【浏览器默认有缓存，对于需要实时更新的数据，取消缓存】</span><br><span class="line"><span class="comment">//浏览器有三消息头设置缓存，为了兼容性！将三个消息头都设置了</span></span><br><span class="line">response.setDateHeader(<span class="string">"Expires"</span>, -<span class="number">1</span>);</span><br><span class="line">response.setHeader(<span class="string">"Cache-Control"</span>, <span class="string">"no-cache"</span>);</span><br><span class="line">response.setHeader(<span class="string">"Pragma"</span>, <span class="string">"no-cache"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="2-6-实现数据压缩"><a href="#2-6-实现数据压缩" class="headerlink" title="2.6 实现数据压缩"></a>2.6 实现数据压缩</h4><p>GZIP类来对数据压缩，把压缩后的数据取出来，写给浏览器</p>
<h4 id="2-7-生成随机图⽚"><a href="#2-7-生成随机图⽚" class="headerlink" title="2.7 生成随机图⽚"></a>2.7 生成随机图⽚</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在内存中⽣成⼀张图⽚,宽为80,⾼为20，类型是RGB</span></span><br><span class="line">BufferedImage bImg = <span class="keyword">new</span> BufferedImage(<span class="number">80</span>, <span class="number">20</span>, BufferedImage.TYPE_INT_RGB);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取到这张图⽚</span></span><br><span class="line">Graphics g = bImg.getGraphics();</span><br><span class="line"></span><br><span class="line"><span class="comment">//往图⽚设置颜⾊和字体</span></span><br><span class="line">g.setColor(Color.white);</span><br><span class="line">g.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">20</span>);</span><br><span class="line">g.setFont(<span class="keyword">new</span> Font(<span class="keyword">null</span>, Font.BOLD, <span class="number">20</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//往图⽚上写数据，先写个12345，横坐标是0，纵坐标是20【⾼度】</span></span><br><span class="line">graphics.drawString(<span class="string">"12345"</span>, <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//要往浏览器写⼀张图⽚，那要告诉浏览器回送的类型是⼀张图⽚</span></span><br><span class="line">response.setHeader(<span class="string">"ContentType"</span>, <span class="string">"jpeg"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//java提供了图⽚流给我们使⽤，这是⼀个⼯具类</span></span><br><span class="line"><span class="comment">//把图⽚传进去，类型是jpg，写给浏览器</span></span><br><span class="line">ImageIO.write(bImg, <span class="string">"jpg"</span>, response.getOutputStream());</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">makeNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Random random = <span class="keyword">new</span> Random();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这样就会⽣成0-7位的随机数，如果不够7位，我们加到7位就⾏了</span></span><br><span class="line">    <span class="keyword">int</span> anInt = random.nextInt(<span class="number">9999999</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//将数字转成是字符串</span></span><br><span class="line">    String num = String.valueOf(anInt);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//判断位数有多少个，不够就加</span></span><br><span class="line">    StringBuffer stringBuffer = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span> - num.length(); i++) &#123;</span><br><span class="line">    	stringBuffer.append(<span class="string">"0"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> stringBuffer.append(num).toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2-8-重定向跳转"><a href="#2-8-重定向跳转" class="headerlink" title="2.8 重定向跳转"></a>2.8 重定向跳转</h4><p>点击⼀个超链接，<strong>通知浏览器</strong>跳转到另外的⼀个⻚⾯就叫重定向跳转。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重定向到index.jsp⻚⾯</span></span><br><span class="line">response.sendRedirect(<span class="string">"/lwclick/index.jsp"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>重定向是通过302状态码和跳转地址实现的</strong></p>
<hr>
<h2 id="Request对象"><a href="#Request对象" class="headerlink" title="Request对象"></a>Request对象</h2><h3 id="1-什么是HttpServletRequest"><a href="#1-什么是HttpServletRequest" class="headerlink" title="1.  什么是HttpServletRequest"></a>1.  什么是HttpServletRequest</h3><p><strong>客户端的请求</strong>，当客户端通过HTTP协议访问服务器时，HTTP请求头中的所有信息都封装在这个对象中，开发⼈员通过这个对象的⽅法，可以获得客户这些信息。</p>
<h3 id="2-常用方法"><a href="#2-常用方法" class="headerlink" title="2. 常用方法"></a>2. 常用方法</h3><ul>
<li>getRequestURL        返回客户端发出请求时的完整URL</li>
<li>getQueryString        返回请求⾏中的参数部分</li>
<li>getRemoteAddr       返回发出请求的客户机的IP地址</li>
<li>getLocalAddr            返回WEB服务器的IP地址</li>
<li>getHeader                 获得客户机请求头</li>
<li><strong>getParameter         获得客户机请求参数(客户端提交的数据)</strong></li>
</ul>
<h3 id="3-应用"><a href="#3-应用" class="headerlink" title="3. 应用"></a>3. 应用</h3><h4 id="3-1-防盗链"><a href="#3-1-防盗链" class="headerlink" title="3.1 防盗链"></a>3.1 防盗链</h4><p>不能使用复制粘贴网址，拿走网站上的资源</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到⽹⻚是从哪⾥来的</span></span><br><span class="line">String referer = request.getHeader(<span class="string">"Referer"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果不是从我的⾸⻚来或者从地址栏直接访问的，</span></span><br><span class="line"><span class="keyword">if</span> ( referer == <span class="keyword">null</span> || !referer.contains(<span class="string">"localhost:8080/lwclick/index.jsp"</span>) ) &#123;</span><br><span class="line">    <span class="comment">//回到⾸⻚去</span></span><br><span class="line">    response.sendRedirect(<span class="string">"/lwclick/index.jsp"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//能执⾏下⾯的语句，说明是从我的⾸⻚点击进来的，那没问题，照常显示</span></span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">response.getWriter().write(<span class="string">"路⻜做了xx"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="3-2-表单提交数据【通过post⽅式提交数据】"><a href="#3-2-表单提交数据【通过post⽅式提交数据】" class="headerlink" title="3.2 表单提交数据【通过post⽅式提交数据】"></a>3.2 表单提交数据【通过post⽅式提交数据】</h4><p>点击提交按钮的时候，数据封装进了FormData中</p>
<p>http请求中把实体主体带过去了【传输的数据称之为实体主体】</p>
<p>既然request对象封装了http请求，所以request对象可以解析到发送过来的数据</p>
<p>于是只要把编码设置成UTF-8就可以解决乱码问题了。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/lwclick/formServlet"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>⽤户名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"男"</span>&gt;</span>男</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"⼥"</span>&gt;</span>⼥</span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>爱好<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobbies"</span> <span class="attr">value</span>=<span class="string">"游泳"</span>&gt;</span>游泳</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobbies"</span> <span class="attr">value</span>=<span class="string">"跑步"</span>&gt;</span>跑步</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobbies"</span> <span class="attr">value</span>=<span class="string">"⻜翔"</span>&gt;</span>⻜翔</span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"aaa"</span> <span class="attr">value</span>=<span class="string">"my name is lwclick"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>你的来⾃于哪⾥<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"address"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"⼴州"</span>&gt;</span>⼴州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"深圳"</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"北京"</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>详细说明:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            	<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">cols</span>=<span class="string">"30"</span> <span class="attr">rows</span>=<span class="string">"2"</span> <span class="attr">name</span>=<span class="string">"textarea"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"reset"</span> <span class="attr">value</span>=<span class="string">"重置"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>在formServlet获取值</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置request字符编码的格式</span></span><br><span class="line">request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过html的name属性，获取到值</span></span><br><span class="line">String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">String gender = request.getParameter(<span class="string">"gender"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//复选框和下拉框有多个值，获取到多个值</span></span><br><span class="line">String[] hobbies = request.getParameterValues(<span class="string">"hobbies"</span>);</span><br><span class="line">String[] address = request.getParameterValues(<span class="string">"address"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取到⽂本域的值</span></span><br><span class="line">String description = request.getParameter(<span class="string">"textarea"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//得到隐藏域的值</span></span><br><span class="line">String hiddenValue = request.getParameter(<span class="string">"aaa"</span>);</span><br><span class="line"></span><br><span class="line">....各种System.out.println().......</span><br></pre></td></tr></table></figure>



<h4 id="3-3-超链接⽅式提交数据-get方式-–-不推荐"><a href="#3-3-超链接⽅式提交数据-get方式-–-不推荐" class="headerlink" title="3.3 超链接⽅式提交数据(get方式) – 不推荐"></a>3.3 超链接⽅式提交数据(get方式) – 不推荐</h4><p>get⽅式不同，它的数据是从消息⾏带过去的，没有封装到request对象⾥⾯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href="/lwclick/formServlet?username=xxx"&gt;使⽤超链接将数据带给浏览器&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">//接收以username为参数名带过来的值</span></span><br><span class="line">String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">System.out.println(username);</span><br></pre></td></tr></table></figure>



<p><strong>sendRedirect()方式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendRedirect(<span class="string">"servlet的地址?参数名="</span>+参数值 &amp;<span class="string">"参数名="</span>+参数值);</span><br></pre></td></tr></table></figure>



<p><strong>中文乱码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//此时得到的数据已经是被ISO 8859-1编码后的字符串了，这个是乱码</span></span><br><span class="line">String name = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//乱码通过反向查ISO 8859-1得到原始的数据</span></span><br><span class="line"><span class="keyword">byte</span>[] bytes = name.getBytes(<span class="string">"ISO8859-1"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过原始的数据，设置正确的码表，构建字符串</span></span><br><span class="line">String value = <span class="keyword">new</span> String(bytes, <span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="3-4-实现转发（不要在转发之前写数据给浏览器）"><a href="#3-4-实现转发（不要在转发之前写数据给浏览器）" class="headerlink" title="3.4 实现转发（不要在转发之前写数据给浏览器）"></a>3.4 实现转发（不要在转发之前写数据给浏览器）</h4><p>使⽤request的<strong>getRequestDispatcher.forward(request,response)</strong>实现转发，做到的功能也是⻚⾯跳转</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调⽤requestDispatcher对象的forward()实现转发,传⼊request和response⽅法</span></span><br><span class="line">request.getRequestDispatcher(<span class="string">"/index.jsp"</span>).forward(request, response);</span><br></pre></td></tr></table></figure>

<p><strong>实现servlet之间的通讯（尽量使用request）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以username为关键字存lwclick值</span></span><br><span class="line">request.setAttribute(<span class="string">"username"</span>, <span class="string">"lwclick"</span>);</span><br><span class="line"></span><br><span class="line">request.getRequestDispatcher(<span class="string">"/reqServlet"</span>).forward(request, response);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取到存进request对象的值</span></span><br><span class="line">String userName = (String) request.getAttribute(<span class="string">"username"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="3-5-转发和重定向的区别（面试题）"><a href="#3-5-转发和重定向的区别（面试题）" class="headerlink" title="3.5 转发和重定向的区别（面试题）"></a>3.5 转发和重定向的区别（面试题）</h4><ul>
<li><p>实际发⽣位置不同，地址栏不同</p>
<ul>
<li><strong>转发</strong>是由<strong>服务器进⾏跳转</strong>的，在转发的时候，<strong>浏览器的地址栏</strong>是<strong>没有发⽣变化</strong>的，实现转发只是⼀次的http请求，⼀次转发中request和response对象都是<strong>同⼀个</strong>。转发是对浏览器透明的。</li>
<li><strong>重定向</strong>是由<strong>浏览器进⾏跳转</strong>的，浏览器的<strong>地址会发⽣变化</strong>的。实现<strong>重定向会发出两个http请求</strong>，request域对象是⽆效的</li>
</ul>
</li>
<li><p>用法不同</p>
<p>​    给<strong>服务器</strong>⽤的直接<strong>从资源名开始写</strong>，给<strong>浏览器</strong>⽤的要<strong>把应⽤名写上</strong></p>
<ul>
<li>request.getRequestDispatcher(“ <strong>/</strong> 资源名 URI”).forward(request,response)<ul>
<li>转发时”/“代表的是本应⽤程序的根⽬录</li>
</ul>
</li>
<li>response.send(“ <strong>/</strong> web应⽤/资源名 URI”)<ul>
<li>重定向时”/“代表的是webapps⽬录</li>
</ul>
</li>
</ul>
</li>
<li><p>能够去往的URL的范围不⼀样</p>
<ul>
<li><strong>转发</strong>是服务器跳转只能去往<strong>当前web应⽤的资源</strong></li>
<li><strong>重定向</strong>是浏览器跳转，可以去往<strong>任何的资源</strong></li>
</ul>
</li>
<li><p>传递数据的类型不同</p>
<ul>
<li>转发的request对象可以传递各种类型的数据，包括对象</li>
<li><strong>重定向</strong>只能传递<strong>字符串</strong></li>
</ul>
</li>
<li><p>跳转的时间不同</p>
<ul>
<li>转发：执⾏到<strong>跳转语句</strong>时就会<strong>⽴刻跳转</strong></li>
<li>重定向：<strong>整个⻚⾯执⾏完之后</strong>才执⾏跳转</li>
</ul>
</li>
<li><p>应⽤场景</p>
<ul>
<li>转发: 访问 Servlet <strong>处理业务逻辑</strong>，然后 forward 到 jsp <strong>显示处理结果</strong>，浏览器⾥ URL 不变</li>
<li>重定向: <strong>提交表单</strong>，处理成功后 redirect 到另⼀个 jsp，<strong>防⽌表单重复提交</strong>，浏览器⾥ URL 变了</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><h3 id="1-会话技术"><a href="#1-会话技术" class="headerlink" title="1. 会话技术"></a>1. 会话技术</h3><p><strong>⽤户开⼀个浏览器，访问⼀个⽹站，只要不关闭该浏览器</strong>，不管该⽤户点击多少个超链接，访问多少资源，直到⽤户关闭浏览器，整个这个过程我们称为<strong>⼀次会话</strong>.</p>
<h3 id="2-Cookie"><a href="#2-Cookie" class="headerlink" title="2. Cookie"></a>2. Cookie</h3><h4 id="2-1-什么是cookie"><a href="#2-1-什么是cookie" class="headerlink" title="2.1 什么是cookie"></a>2.1 什么是cookie</h4><p>⽹⻚之间的交互是通过HTTP协议传输数据的，⽽<strong>Http协议是无状态，不安全的协议</strong>（⼀旦数据提交完后，浏览器和服务器的连接就会关闭，再次交互的时候需要重新建⽴新的连接。）</p>
<p>W3C提出了：给每⼀个⽤户都发⼀个通⾏证，⽆论谁访问的时候都需要携带通⾏证，这样服务器就可以从通⾏证上确认⽤户的信息。<strong>通⾏证就是Cookie</strong></p>
<p><strong>流程：</strong></p>
<ul>
<li>浏览器访问服务器，如果服务器需要记录该⽤户的状态，就<strong>使⽤response</strong>向浏览器发送⼀个Cookie，浏览器会把Cookie保存起来</li>
<li>当浏览器再次访问服务器的时候，浏览器会把请求的⽹址连同Cookie⼀同交给服务器。</li>
</ul>
<h4 id="2-2-常⽤的Cookie⽅法"><a href="#2-2-常⽤的Cookie⽅法" class="headerlink" title="2.2 常⽤的Cookie⽅法"></a>2.2 常⽤的Cookie⽅法</h4><ul>
<li>public Cookie(String name,String value)</li>
<li>setValue与getValue⽅法</li>
<li>setMaxAge与getMaxAge⽅法</li>
<li>setPath与getPath⽅法</li>
<li>setDomain与getDomain⽅法</li>
<li>getName⽅法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置response的编码</span></span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建Cookie对象，指定名称和值</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"username"</span>, <span class="string">"lwclick"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置Cookie的时间</span></span><br><span class="line">cookie.setMaxAge(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//向浏览器给⼀个Cookie</span></span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">response.getWriter().write(<span class="string">"我已经向浏览器发送了⼀个Cookie"</span>);</span><br></pre></td></tr></table></figure>



<h4 id="2-3-Cookie细节"><a href="#2-3-Cookie细节" class="headerlink" title="2.3 Cookie细节"></a>2.3 Cookie细节</h4><h5 id="2-3-1-不可跨域名性"><a href="#2-3-1-不可跨域名性" class="headerlink" title="2.3.1 不可跨域名性"></a>2.3.1 不可跨域名性</h5><p> 浏览器通过<strong>域名</strong>判断⼀个⽹站是否能操作另⼀个⽹站的Cookie。</p>
<p>即使⼀级域名相同，⼆级域名不同，也不能获取到Cookie</p>
<h5 id="2-3-2-Cookie保存中⽂"><a href="#2-3-2-Cookie保存中⽂" class="headerlink" title="2.3.2 Cookie保存中⽂"></a>2.3.2 Cookie保存中⽂</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">PrintWriter printWriter = response.getWriter();</span><br><span class="line"></span><br><span class="line">String name = <span class="string">"中国"</span>;</span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"country"</span>, URLEncoder.encode(name, <span class="string">"UTF-8"</span>));</span><br><span class="line">cookie.setMaxAge(<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//⼀定不要忘记添加到浏览器中</span></span><br><span class="line">response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">printWriter.write(<span class="string">"我颁发了⼀个Cookie，值保存的是中⽂数据"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">【取出Cookie】</span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; cookies != <span class="keyword">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">    String name = cookies[i].getName();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//经过URLEncoding就要URLDecoding</span></span><br><span class="line">    String value = URLDecoder.decode(cookies[i].getValue(), <span class="string">"UTF-8"</span>);</span><br><span class="line">    printWriter.write(name + <span class="string">"------"</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="2-3-3-Cookie的有效期"><a href="#2-3-3-Cookie的有效期" class="headerlink" title="2.3.3 Cookie的有效期"></a>2.3.3 Cookie的有效期</h5><p>有效期通过setMaxAge()来设置</p>
<ul>
<li><p>MaxAge为<strong>正数</strong>，浏览器将Cookie写到硬盘中，只要还在MaxAge秒之前，登陆⽹站时该Cookie就有效【不论关闭了浏览器还是电脑】</p>
</li>
<li><p>MaxAge为<strong>负数</strong>，Cookie是临时性的，仅在本浏览器内有效</p>
</li>
<li><p>MaxAge为<strong>0</strong>，则表示<strong>删除</strong>该Cookie（<strong>需要添加到浏览器中</strong>）。</p>
</li>
</ul>
<h4 id="2-4-Cookie的应⽤"><a href="#2-4-Cookie的应⽤" class="headerlink" title="2.4 Cookie的应⽤"></a>2.4 Cookie的应⽤</h4><h5 id="2-4-1-显示⽤户上次访问的时间"><a href="#2-4-1-显示⽤户上次访问的时间" class="headerlink" title="2.4.1 显示⽤户上次访问的时间"></a>2.4.1 显示⽤户上次访问的时间</h5><p>用户每次登陆的时候，取到Cookie保存的值，再更新下Cookie的值。</p>
<p>访问Serlvet有两种情况</p>
<ul>
<li>第⼀次访问</li>
<li>已经访问过了</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">PrintWriter printWriter = response.getWriter();</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取⽹⻚上所有的Cookie</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断Cookie的值是否为空</span></span><br><span class="line">String cookieValue = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; cookies != <span class="keyword">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//获取到以time为名的Cookie</span></span><br><span class="line">    <span class="keyword">if</span> (cookies[i].getName().equals(<span class="string">"time"</span>)) &#123;</span><br><span class="line">        printWriter.write(<span class="string">"您上次登陆的时间是："</span>);</span><br><span class="line">        cookieValue = cookies[i].getValue();</span><br><span class="line">        printWriter.write(cookieValue);</span><br><span class="line">        </span><br><span class="line">        cookies[i].setValue(simpleDateFormat.format(<span class="keyword">new</span> Date()));</span><br><span class="line">        response.addCookie(cookies[i]);</span><br><span class="line">        <span class="comment">//既然已经找到了就可以break循环了</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果Cookie的值是空的，那么就是第⼀次访问</span></span><br><span class="line"><span class="keyword">if</span> (cookieValue == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">//创建⼀个Cookie对象，⽇期为当前时间</span></span><br><span class="line">    Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"time"</span>, simpleDateFormat.format(<span class="keyword">new</span> Date()));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置Cookie的⽣命期</span></span><br><span class="line">    cookie.setMaxAge(<span class="number">20000</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//response对象回送Cookie给浏览器</span></span><br><span class="line">    response.addCookie(cookie);</span><br><span class="line">    printWriter.write(<span class="string">"您是第⼀次登陆啊！"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="2-4-2-显示上次浏览过商品"><a href="#2-4-2-显示上次浏览过商品" class="headerlink" title="2.4.2 显示上次浏览过商品"></a>2.4.2 显示上次浏览过商品</h5><p>以书籍为例⼦！⾸先设计Book对象</p>
<hr>
<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><p>另⼀种记录浏览器状态的机制，<strong>Cookie保存在浏览器中，Session保存在服务器中。</strong></p>
<h3 id="1-Session-API"><a href="#1-Session-API" class="headerlink" title="1. Session API"></a>1. Session API</h3><ul>
<li>String getId();                                                              【获取Session的id】</li>
<li>void setMaxInactiveInterval(int var1);                    【设置Session超时时间】</li>
<li>int getMaxInactiveInterval();                                    【获取Session超时时间】</li>
<li>Object getAttribute(String var1);                             【获取Session属性】</li>
<li>Enumeration getAttributeNames();                        【获取Session所有的属性名】</li>
<li>void setAttribute(String var1, Object var2);          【设置Session属性】</li>
<li>void removeAttribute(String var1);                        【移除Session属性】</li>
<li>void invalidate();                                                       【销毁该Session】</li>
</ul>
<h3 id="2-Session作为域对象"><a href="#2-Session作为域对象" class="headerlink" title="2. Session作为域对象"></a>2. Session作为域对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//得到Session对象</span></span><br><span class="line">HttpSession httpSession = request.getSession();</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置Session属性</span></span><br><span class="line">httpSession.setAttribute(<span class="string">"name"</span>, <span class="string">"看完博客就要点赞！！"</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到从上面Servlet的Session存进去的值</span></span><br><span class="line">HttpSession httpSession = request.getSession();</span><br><span class="line">String value = (String) httpSession.getAttribute(<span class="string">"name"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(value);</span><br></pre></td></tr></table></figure>



<h3 id="3-Session的⽣命周期和有效期"><a href="#3-Session的⽣命周期和有效期" class="headerlink" title="3. Session的⽣命周期和有效期"></a>3. Session的⽣命周期和有效期</h3><ul>
<li><p>⽤户第⼀次访问服务器<strong>Servlet</strong>，jsp等动态资源就会被⾃动创建，Session对象保存在内存⾥</p>
</li>
<li><p>Session⽣成后，只要<strong>⽤户继续访问</strong>，服务器就会更新Session的最后访问时间，⽆论是否对Session进⾏读写，服务器都会认为Session活跃了⼀次。</p>
</li>
<li><p>为了防⽌内存溢出，服务器会把⻓时间没有活跃的Session从内存中删除，这个时间也就是Session的超时时间。（默认30分钟）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置Session最⻓超时时间为60秒，这⾥的单位是秒</span></span><br><span class="line">httpSession.setMaxInactiveInterval(<span class="number">60</span>);</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="4-Session的实现原理"><a href="#4-Session的实现原理" class="headerlink" title="4. Session的实现原理"></a>4. Session的实现原理</h3><p>Session 之所以可以识别不同的⽤户，依靠的就是Cookie</p>
<p>该Cookie是服务器⾃动颁发给浏览器的，不⽤⼿⼯创建的。该Cookie的maxAge值默认是-1，也就是说仅当前浏览器使⽤，不将该Cookie存在硬盘中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">当我们访问Servlet1的时候，服务器就会创建⼀个Session对象，执⾏我们的程序代码，并⾃动颁发个Cookie给⽤户浏览器</span><br><span class="line"></span><br><span class="line">当我们⽤同⼀个浏览器访问Servlet2的时候，浏览器会把Cookie的值通过http协议带过去给服务器，服务器就知道⽤哪⼀Session。</span><br><span class="line"></span><br><span class="line">⽽当我们使⽤新会话的浏览器访问Servlet2的时候，该新浏览器并没有Cookie，服务器⽆法辨认使⽤哪⼀个Session，所以就获取不到值</span><br></pre></td></tr></table></figure>



<p>禁⽤了Cookie，通过URL地址重写</p>
<ul>
<li>encodeURL(String url)</li>
<li>encodeRedirectURL(String url)</li>
</ul>
<h3 id="5-Session案例"><a href="#5-Session案例" class="headerlink" title="5. Session案例"></a>5. Session案例</h3><h4 id="5-1-使⽤Session完成⽤户简单登陆"><a href="#5-1-使⽤Session完成⽤户简单登陆" class="headerlink" title="5.1 使⽤Session完成⽤户简单登陆"></a>5.1 使⽤Session完成⽤户简单登陆</h4><p>创建User类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String username = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">private</span> String password = <span class="keyword">null</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.username = username;</span><br><span class="line">    <span class="keyword">this</span>.password = password;</span><br><span class="line">&#125;</span><br><span class="line">....各种set、get⽅法</span><br></pre></td></tr></table></figure>

<p>集合模拟⼀个数据库</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="comment">//装载些数据进数据库</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    list.add(<span class="keyword">new</span> User(<span class="string">"aaa"</span>,<span class="string">"111"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> User(<span class="string">"bbb"</span>,<span class="string">"222"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> User(<span class="string">"ccc"</span>,<span class="string">"333"</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//通过⽤户名和密码查找⽤户</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User <span class="title">find</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (user.getUsername().equals(username) &amp;&amp;</span><br><span class="line">            user.getPassword().equals(password)) &#123;</span><br><span class="line">            	<span class="keyword">return</span> user;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>表单提交</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/ouzicheng/LoginServlet"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    ⽤户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>获取到表单提交的数据，查找数据库是否有相对应的⽤户名和密码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"></span><br><span class="line">User user = UserDB.find(username, password);</span><br><span class="line"><span class="comment">//如果找不到，就是⽤户名或密码出错了。</span></span><br><span class="line"><span class="keyword">if</span> (user == <span class="keyword">null</span>) &#123;</span><br><span class="line">    response.getWriter().write(<span class="string">"you can't login"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//标记着该⽤户已经登陆了！</span></span><br><span class="line">HttpSession httpSession = request.getSession();</span><br><span class="line">httpSession.setAttribute(<span class="string">"user"</span>, user);</span><br><span class="line"><span class="comment">//跳转到其他⻚⾯，告诉⽤户成功登陆了。</span></span><br><span class="line"></span><br><span class="line">response.sendRedirect(response.encodeURL(<span class="string">"index.jsp"</span>));</span><br></pre></td></tr></table></figure>



<h4 id="5-2-利⽤Session防⽌表单重复提交"><a href="#5-2-利⽤Session防⽌表单重复提交" class="headerlink" title="5.2 利⽤Session防⽌表单重复提交"></a>5.2 利⽤Session防⽌表单重复提交</h4><ul>
<li>在session域中存储⼀个token</li>
<li>然后前台⻚⾯的隐藏域获取得到这个token</li>
<li>在第⼀次访问的时候，我们就判断seesion有没有值，如果有就⽐对。对⽐正确后我们就处理请求，接着就把session存储的数据给删除了</li>
<li>等到再次访问的时候，我们session就没有值了，就不受理前台的请求了！</li>
</ul>
<h4 id="5-3-一次性校验码"><a href="#5-3-一次性校验码" class="headerlink" title="5.3 一次性校验码"></a>5.3 一次性校验码</h4><p>⽣成验证码后，把验证码的数据存进Session域对象中，判断⽤户输⼊验证码是否和Session域对象的数据⼀致。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在内存中⽣成图⽚</span></span><br><span class="line">BufferedImage bImg = <span class="keyword">new</span> BufferedImage(<span class="number">80</span>, <span class="number">20</span>,BufferedImage.TYPE_INT_RGB);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取到这张图⽚</span></span><br><span class="line">Graphics2D gp2D = (Graphics2D) bImg.getGraphics();</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置背景⾊为⽩⾊</span></span><br><span class="line">gp2D.setColor(Color.white);</span><br><span class="line">gp2D.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置图⽚的字体和颜⾊</span></span><br><span class="line">gp2D.setFont(<span class="keyword">new</span> Font(<span class="keyword">null</span>, Font.BOLD, <span class="number">20</span>));</span><br><span class="line">gp2D.setColor(Color.BLUE);</span><br><span class="line"></span><br><span class="line"><span class="comment">//⽣成随机数</span></span><br><span class="line">String randomNum = makeNum();</span><br><span class="line"></span><br><span class="line"><span class="comment">//往这张图⽚上写数据,横坐标是0，纵坐标是20</span></span><br><span class="line">gp2D.drawString(randomNum, <span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将随机数存进Session域中</span></span><br><span class="line">request.getSession().setAttribute(<span class="string">"randomNum"</span>, randomNum);</span><br><span class="line"></span><br><span class="line"><span class="comment">//控制浏览器不缓存该图⽚</span></span><br><span class="line">response.setHeader(<span class="string">"Expires"</span>, <span class="string">"-1"</span>);</span><br><span class="line">response.setHeader(<span class="string">"Cache-Control"</span>, <span class="string">"no-cache"</span>);</span><br><span class="line">response.setHeader(<span class="string">"Pragma"</span>, <span class="string">"no-cache"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//通知浏览器以图⽚的⽅式打开</span></span><br><span class="line">response.setHeader(<span class="string">"Content-type"</span>, <span class="string">"image/jpeg"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//把图⽚写给浏览器</span></span><br><span class="line">ImageIO.write(bImg, <span class="string">"jpg"</span>, response.getOutputStream());</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">makeNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Random random = <span class="keyword">new</span> Random();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//⽣成0-6位的随机数(6个9)</span></span><br><span class="line">    <span class="keyword">int</span> num = random.nextInt(<span class="number">999999</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//验证码的数位全都要6位数，于是将该随机数转换成字符串，不够位数就添加</span></span><br><span class="line">    String randomNum = String.valueOf(num);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使⽤StringBuffer来拼凑字符串</span></span><br><span class="line">    StringBuffer stringBuffer = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span> - randomNum.length(); i++) &#123;</span><br><span class="line">    	stringBuffer.append(i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> stringBuffer.append(randomNum).toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>显示页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/ouzicheng/Login2Servlet"</span>&gt;</span></span><br><span class="line">    ⽤户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    验证码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"randomNum"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/ouzicheng/ImageServlet"</span> &gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>处理提交表单数据的<strong>Servlet</strong>，判断⽤户带过来验证码的数据是否和Session的数据相同。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取⽤户输⼊验证码的数据</span></span><br><span class="line">String client_randomNum = request.getParameter(<span class="string">"randomNum"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取Session中的数据</span></span><br><span class="line">String session_randomNum = (String) request.getSession().getAttribute(<span class="string">"randomNum"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断他俩数据是否相等，⽤户是否有输⼊验证码，Session中是否为空</span></span><br><span class="line"><span class="keyword">if</span> (client_randomNum == <span class="keyword">null</span> || session_randomNum == <span class="keyword">null</span> || !client_randomNum.equals(session_randomNum)) &#123;</span><br><span class="line">    System.out.println(<span class="string">"验证码错误了！！！"</span>);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//下⾯就是验证⽤户名和密码...................</span></span><br></pre></td></tr></table></figure>



<h3 id="6-Session和Cookie的区别（面试题）"><a href="#6-Session和Cookie的区别（面试题）" class="headerlink" title="6. Session和Cookie的区别（面试题）"></a>6. Session和Cookie的区别（面试题）</h3><ul>
<li>从存储⽅式上⽐较<ul>
<li>Cookie只能存储字符串，如果要存储⾮ASCII字符串还要对其编码。</li>
<li>Session可以存储任何类型的数据，可以把Session看成是⼀个容器</li>
</ul>
</li>
<li>从隐私安全上⽐较<ul>
<li>Cookie存储在浏览器中，对客户端是可⻅的。信息容易泄露出去。如果使⽤Cookie，最好将Cookie加密</li>
<li>Session存储在服务器上，对客户端是透明的。不存在敏感信息泄露问题。</li>
</ul>
</li>
<li>从有效期上⽐较<ul>
<li>Cookie保存在硬盘中，只需要设置maxAge属性为⽐较⼤的正整数，即使关闭浏览器，Cookie还是存在的</li>
<li>Session的保存在服务器中，设置maxInactiveInterval属性值来确定Session的有效期。<ul>
<li>并且Session依赖于名为JSESSIONID的Cookie，该Cookie默认的maxAge属性为-1。</li>
<li>如果关闭了浏览器，该Session虽然没有从服务器中消亡，但也就失效了。</li>
</ul>
</li>
</ul>
</li>
<li>从对服务器的负担⽐较<ul>
<li>Session是保存在服务器的，每个⽤户都会产⽣⼀个Session，如果是并发访问的⽤户⾮常多，是不能使⽤Session的，Session会消耗⼤量的内存。</li>
<li>Cookie是保存在客户端的。不占⽤服务器的资源。像baidu、Sina这样的⼤型⽹站，⼀般都是使⽤Cookie来进⾏会话跟踪。</li>
</ul>
</li>
<li>从浏览器的⽀持上⽐较<ul>
<li>如果浏览器禁⽤了Cookie，那么Cookie是⽆⽤的了！</li>
<li>如果浏览器禁⽤了Cookie，Session可以通过URL地址重写来进⾏会话跟踪。</li>
</ul>
</li>
<li>从跨域名上⽐较<ul>
<li>Cookie可以设置domain属性来实现跨域名</li>
<li>Session只在当前的域名内有效，不可夸域名</li>
</ul>
</li>
</ul>
<h3 id="7-session和cookie共同使用"><a href="#7-session和cookie共同使用" class="headerlink" title="7. session和cookie共同使用"></a>7. session和cookie共同使用</h3><p>把Cookie保存在硬盘中，即使我关闭了浏览器，浏览器再次访问⻚⾯的时候，可以带上Cookie，从⽽服务器识别出Session。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"JSESSIONID"</span>,session.getId());</span><br><span class="line">cookie.setMaxAge(<span class="number">30</span>*<span class="number">60</span>);</span><br><span class="line">cookie.setPath(<span class="string">"/lwclick/"</span>);</span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><h3 id="1-Tomcat常⻅⾯试题"><a href="#1-Tomcat常⻅⾯试题" class="headerlink" title="1. Tomcat常⻅⾯试题"></a>1. Tomcat常⻅⾯试题</h3><h4 id="1-1-1-1Tomcat的缺省端⼝是多少，怎么修改"><a href="#1-1-1-1Tomcat的缺省端⼝是多少，怎么修改" class="headerlink" title="1.1 1.1Tomcat的缺省端⼝是多少，怎么修改"></a>1.1 1.1Tomcat的缺省端⼝是多少，怎么修改</h4><p>默认8080 </p>
<ol>
<li><p>找到Tomcat⽬录下的conf⽂件夹</p>
</li>
<li><p>进⼊conf⽂件夹⾥⾯找到server.xml⽂件</p>
</li>
<li><p>打开server.xml⽂件</p>
</li>
<li><p>在server.xml⽂件⾥⾯找到下列信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"Catalina"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">redirectPort</span>=<span class="string">"8443"</span> /&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<h4 id="1-2-Tomcat-有哪⼏种Connector-运⾏模式-优化-？"><a href="#1-2-Tomcat-有哪⼏种Connector-运⾏模式-优化-？" class="headerlink" title="1.2 Tomcat 有哪⼏种Connector 运⾏模式(优化)？"></a>1.2 Tomcat 有哪⼏种Connector 运⾏模式(优化)？</h4><ol>
<li>bio(blocking I/O)</li>
<li>nio(non-blocking I/O)</li>
<li>apr(Apache Portable Runtime/Apache可移植运⾏库)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tomcat将以JNI的形式调⽤Apache HTTP服务器的核⼼动态链接库来处理⽂件读取或⽹络传输操作，从⽽⼤⼤地 提⾼Tomcat对静态⽂件的处理性能</span><br></pre></td></tr></table></figure>



<h3 id="2-Servlet⾯试题"><a href="#2-Servlet⾯试题" class="headerlink" title="2.Servlet⾯试题"></a>2.Servlet⾯试题</h3><h4 id="2-1-get式和post⽅式有何区别"><a href="#2-1-get式和post⽅式有何区别" class="headerlink" title="2.1 get式和post⽅式有何区别"></a>2.1 get式和post⽅式有何区别</h4><p>数据携带上:<br>GET⽅式：在URL地址后附带的参数是有限制的，其数据容量通常不能超过1K。<br>POST⽅式：可以在请求的实体内容中向服务器发送数据，传送的数据量⽆限制。<br>请求参数的位置上:<br>GET⽅式：请求参数放在URL地址后⾯，以?的⽅式来进⾏拼接<br>POST⽅式:请求参数放在HTTP请求包中<br>⽤途上:<br>GET⽅式⼀般⽤来获取数据<br>POST⽅式⼀般⽤来提交数据<br>原因:<br>⾸先是因为GET⽅式携带的数据量⽐较⼩，⽆法带过去很⼤的数量<br>POST⽅式提交的参数后台更加容易解析(使⽤POST⽅式提交的中⽂数据，后台也更加容<br>易解决)<br>GET⽅式⽐POST⽅式要快</p>
<h4 id="2-2-tomcat容器是如何创建servlet类实例？"><a href="#2-2-tomcat容器是如何创建servlet类实例？" class="headerlink" title="2.2 tomcat容器是如何创建servlet类实例？"></a>2.2 tomcat容器是如何创建servlet类实例？</h4><ol>
<li>当容器启动时，会读取在webapps⽬录下所有的web应⽤中的web.xml⽂件，然后对 xml⽂件进⾏解析，并读取servlet注册信息。然后，将每个应⽤中注册的servlet类都进⾏加载，并通过 <strong>反射</strong> 的⽅式实例化。（有时候也是在第⼀次请求时实例化）</li>
<li>在servlet注册时加上<load-on-startup> 1 </load-on-startup> 如果为<strong>正数</strong>，则在⼀开始就实例化，如果不写或为负数，则第⼀次请求实例化。</li>
</ol>

      
    </div>
    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.jpg" alt="xCoding wechat" style="width: 200px; max-width: 100%;"/>
    <div>欢迎您扫一扫上面的微信公众号，订阅我的博客！</div>
</div>

      </div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="xCoding 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="xCoding 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/05/15/Redis/" rel="next" title="redis">
                <i class="fa fa-chevron-left"></i> redis
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/05/15/spring/" rel="prev" title="spring">
                spring <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://gitee.com/lwclick/blogImg/raw/master/img/959e5d02246fb23f5d5f613f7767eeac.jpeg"
                alt="xCoding" />
            
              <p class="site-author-name" itemprop="name">xCoding</p>
              <p class="site-description motion-element" itemprop="description">change the world by code</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/LwClick" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:Liu17663883288@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.baidu.com/" title="Baidu" target="_blank">Baidu</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.google.com.hk/" title="Google" target="_blank">Google</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Tomcat"><span class="nav-number">1.</span> <span class="nav-text">Tomcat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet"><span class="nav-number">2.</span> <span class="nav-text">Servlet</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-什么是Servlet？"><span class="nav-number">2.1.</span> <span class="nav-text">1. 什么是Servlet？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-HTTP协议"><span class="nav-number">2.2.</span> <span class="nav-text">2. HTTP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-什么是HTPP协议"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.1 什么是HTPP协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-HTTP1-0和HTTP1-1的区别"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2 HTTP1.0和HTTP1.1的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-HTTP请求"><span class="nav-number">2.2.3.</span> <span class="nav-text">2.3 HTTP请求</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-1-请求行"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">2.3.1 请求行</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-请求头"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">2.3.2 请求头</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-HTTP响应"><span class="nav-number">2.2.4.</span> <span class="nav-text">2.4 HTTP响应</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-1-状态⾏"><span class="nav-number">2.2.4.1.</span> <span class="nav-text">2.4.1 状态⾏</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-2-响应头"><span class="nav-number">2.2.4.2.</span> <span class="nav-text">2.4.2 响应头</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-servlet生命周期（面试题）"><span class="nav-number">2.3.</span> <span class="nav-text">3. servlet生命周期（面试题）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-servlet编写"><span class="nav-number">2.4.</span> <span class="nav-text">4. servlet编写</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#细节问题"><span class="nav-number">3.</span> <span class="nav-text">细节问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-servlet细节"><span class="nav-number">3.1.</span> <span class="nav-text">1. servlet细节</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-⼀个已经注册的Servlet可以被多次映射"><span class="nav-number">3.1.1.</span> <span class="nav-text">1.1 ⼀个已经注册的Servlet可以被多次映射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-Servlet映射的URL可以使⽤通配符"><span class="nav-number">3.1.2.</span> <span class="nav-text">1.2 Servlet映射的URL可以使⽤通配符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-Servlet是单例的（面试题）"><span class="nav-number">3.1.3.</span> <span class="nav-text">1.3 Servlet是单例的（面试题）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-load-on-startup"><span class="nav-number">3.1.4.</span> <span class="nav-text">1.4 load-on-startup</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-5-在web访问任何资源都是在访问servlet"><span class="nav-number">3.1.5.</span> <span class="nav-text">1.5 在web访问任何资源都是在访问servlet</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-ServletConfig对象"><span class="nav-number">3.2.</span> <span class="nav-text">2. ServletConfig对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-ServletConfig对象有什么⽤？"><span class="nav-number">3.2.1.</span> <span class="nav-text">2.1 ServletConfig对象有什么⽤？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-ServletContext对象"><span class="nav-number">3.3.</span> <span class="nav-text">3. ServletContext对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-什么是ServletContext对象？"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.1 什么是ServletContext对象？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-ServletContext有什么⽤？"><span class="nav-number">3.3.2.</span> <span class="nav-text">3.2 ServletContext有什么⽤？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-Servlet之间实现通讯"><span class="nav-number">3.3.3.</span> <span class="nav-text">3.3 Servlet之间实现通讯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-获取web站点配置的信息"><span class="nav-number">3.3.4.</span> <span class="nav-text">3.4 获取web站点配置的信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-读取资源文件"><span class="nav-number">3.3.5.</span> <span class="nav-text">3.5 读取资源文件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Response对象"><span class="nav-number">4.</span> <span class="nav-text">Response对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-response、request对象"><span class="nav-number">4.1.</span> <span class="nav-text">1. response、request对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-HttpServletResponse的应⽤"><span class="nav-number">4.2.</span> <span class="nav-text">2. HttpServletResponse的应⽤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-调⽤getOutputStream-⽅法向浏览器输出数据"><span class="nav-number">4.2.1.</span> <span class="nav-text">2.1 调⽤getOutputStream()⽅法向浏览器输出数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-调⽤getWriter-⽅法向浏览器输出数据"><span class="nav-number">4.2.2.</span> <span class="nav-text">2.2 调⽤getWriter()⽅法向浏览器输出数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-实现⽂件下载"><span class="nav-number">4.2.3.</span> <span class="nav-text">2.3 实现⽂件下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-实现自动刷新"><span class="nav-number">4.2.4.</span> <span class="nav-text">2.4 实现自动刷新</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-设置缓存"><span class="nav-number">4.2.5.</span> <span class="nav-text">2.5 设置缓存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-实现数据压缩"><span class="nav-number">4.2.6.</span> <span class="nav-text">2.6 实现数据压缩</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-生成随机图⽚"><span class="nav-number">4.2.7.</span> <span class="nav-text">2.7 生成随机图⽚</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-重定向跳转"><span class="nav-number">4.2.8.</span> <span class="nav-text">2.8 重定向跳转</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Request对象"><span class="nav-number">5.</span> <span class="nav-text">Request对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-什么是HttpServletRequest"><span class="nav-number">5.1.</span> <span class="nav-text">1.  什么是HttpServletRequest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-常用方法"><span class="nav-number">5.2.</span> <span class="nav-text">2. 常用方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-应用"><span class="nav-number">5.3.</span> <span class="nav-text">3. 应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-防盗链"><span class="nav-number">5.3.1.</span> <span class="nav-text">3.1 防盗链</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-表单提交数据【通过post⽅式提交数据】"><span class="nav-number">5.3.2.</span> <span class="nav-text">3.2 表单提交数据【通过post⽅式提交数据】</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-超链接⽅式提交数据-get方式-–-不推荐"><span class="nav-number">5.3.3.</span> <span class="nav-text">3.3 超链接⽅式提交数据(get方式) – 不推荐</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-实现转发（不要在转发之前写数据给浏览器）"><span class="nav-number">5.3.4.</span> <span class="nav-text">3.4 实现转发（不要在转发之前写数据给浏览器）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-转发和重定向的区别（面试题）"><span class="nav-number">5.3.5.</span> <span class="nav-text">3.5 转发和重定向的区别（面试题）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cookie"><span class="nav-number">6.</span> <span class="nav-text">Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-会话技术"><span class="nav-number">6.1.</span> <span class="nav-text">1. 会话技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Cookie"><span class="nav-number">6.2.</span> <span class="nav-text">2. Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-什么是cookie"><span class="nav-number">6.2.1.</span> <span class="nav-text">2.1 什么是cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-常⽤的Cookie⽅法"><span class="nav-number">6.2.2.</span> <span class="nav-text">2.2 常⽤的Cookie⽅法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-Cookie细节"><span class="nav-number">6.2.3.</span> <span class="nav-text">2.3 Cookie细节</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-1-不可跨域名性"><span class="nav-number">6.2.3.1.</span> <span class="nav-text">2.3.1 不可跨域名性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-2-Cookie保存中⽂"><span class="nav-number">6.2.3.2.</span> <span class="nav-text">2.3.2 Cookie保存中⽂</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-3-Cookie的有效期"><span class="nav-number">6.2.3.3.</span> <span class="nav-text">2.3.3 Cookie的有效期</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-Cookie的应⽤"><span class="nav-number">6.2.4.</span> <span class="nav-text">2.4 Cookie的应⽤</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-1-显示⽤户上次访问的时间"><span class="nav-number">6.2.4.1.</span> <span class="nav-text">2.4.1 显示⽤户上次访问的时间</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4-2-显示上次浏览过商品"><span class="nav-number">6.2.4.2.</span> <span class="nav-text">2.4.2 显示上次浏览过商品</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session"><span class="nav-number">7.</span> <span class="nav-text">Session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Session-API"><span class="nav-number">7.1.</span> <span class="nav-text">1. Session API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Session作为域对象"><span class="nav-number">7.2.</span> <span class="nav-text">2. Session作为域对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Session的⽣命周期和有效期"><span class="nav-number">7.3.</span> <span class="nav-text">3. Session的⽣命周期和有效期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Session的实现原理"><span class="nav-number">7.4.</span> <span class="nav-text">4. Session的实现原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Session案例"><span class="nav-number">7.5.</span> <span class="nav-text">5. Session案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-使⽤Session完成⽤户简单登陆"><span class="nav-number">7.5.1.</span> <span class="nav-text">5.1 使⽤Session完成⽤户简单登陆</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-利⽤Session防⽌表单重复提交"><span class="nav-number">7.5.2.</span> <span class="nav-text">5.2 利⽤Session防⽌表单重复提交</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-一次性校验码"><span class="nav-number">7.5.3.</span> <span class="nav-text">5.3 一次性校验码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-Session和Cookie的区别（面试题）"><span class="nav-number">7.6.</span> <span class="nav-text">6. Session和Cookie的区别（面试题）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-session和cookie共同使用"><span class="nav-number">7.7.</span> <span class="nav-text">7. session和cookie共同使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面试题"><span class="nav-number">8.</span> <span class="nav-text">面试题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Tomcat常⻅⾯试题"><span class="nav-number">8.1.</span> <span class="nav-text">1. Tomcat常⻅⾯试题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-1Tomcat的缺省端⼝是多少，怎么修改"><span class="nav-number">8.1.1.</span> <span class="nav-text">1.1 1.1Tomcat的缺省端⼝是多少，怎么修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-Tomcat-有哪⼏种Connector-运⾏模式-优化-？"><span class="nav-number">8.1.2.</span> <span class="nav-text">1.2 Tomcat 有哪⼏种Connector 运⾏模式(优化)？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Servlet⾯试题"><span class="nav-number">8.2.</span> <span class="nav-text">2.Servlet⾯试题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-get式和post⽅式有何区别"><span class="nav-number">8.2.1.</span> <span class="nav-text">2.1 get式和post⽅式有何区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-tomcat容器是如何创建servlet类实例？"><span class="nav-number">8.2.2.</span> <span class="nav-text">2.2 tomcat容器是如何创建servlet类实例？</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xCoding</span>

  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i>
<span id="busuanzi_container_site_uv">
    总访问量：<span id="busuanzi_value_site_uv"></span>
</span>
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("6FvwPSgS2qi2N65NMEAkPoh2-gzGzoHsz", "S8r7yFHoBqgsyT8MP9bTGC1R");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
